#  一、微服务概述

## 1、什么是微服务

通常而言，微服务架构是一种架构模式或者说一种架构风格，==它提倡将单一应用程序划分成一组小的服务==，每个服务运行在其独立的自己的==进程中==，服务之间互相协调、互相配合，为用户提供最终价值。服务之间采用轻量级的通信机制互相沟通（通常是基于HTTP的RESTful API）。每个服务都围绕着具体业务进行构建，并且能够独立的部署到生产环境、类生产环境等。另外应尽量避免统一的、集中式的服务管理机制，对具体的一个服务而言，应根据业务上下文，选择合适的语言、工具对其进行构建，可以有一个非常轻量级的集中式管理来协调这些服务，可以使用不同的语言来编写服务，也可以使用不同的数据存储。



微服务化的核心就是将传统的一站式应用，根据业务拆分成一个一个的服务，彻底地去耦合，每一个微服务提供单个业务功能的服务，一个服务做一件事，从技术的角度看就是一种小而独立的处理过程，类似进程概念，能够自行单独启动或销毁，拥有自己独立的数据库。

## 2、微服务与微服务架构

- 微服务

  强调的是服务的大小，它关注的是某一个点，是具体解决某一问题/提供落地对应服务的一个服务应用，狭义的看，可以看做eclipse里面的一个个微服务工程/或者Module

- 微服务架构

  微服务架构是一种架构模式，它提倡将单一应用程序划分成一组小的服务，服务之间互相协调、互相配合，为用户提供最终价值。每个服务运行在其==独立的进程中==，服务与服务间采用轻量级的通信机制互相协作（通常基于HTTP协议的RESTful API）。每个服务都围绕着具体业务进行构建，并且能够被独立的部署到生产环境、类生产环境等。另外，==应尽量避免统一的、集中式的服务管理机制==，对具体的一个服务而言，应根据业务上下文，选择合适的语言、工具对其进行构建。

## 3、微服务优缺点

- ==优点==
  - 每个服务足够内聚，足够小，代码容易理解这样能聚焦一个指定的业务功能或业务需求。
  - 开发简单、开发效率提高，一个服务可能就是专一的只干一件事。
  - 微服务能够被小团队单独开发，这个小团队是2到5人的开发人员组成。
  - 微服务是松耦合的，是有功能意义的服务，无论是在开发阶段或部署阶段都是独立的。
  - 微服务能使用不同的语言开发。
  - 易于和第三方集成，微服务允许容易且灵活的方式集成自动部署，通过持续集成工具，如Jenkins，Hudson，bamboo.
  - ==微服务只是业务逻辑代码，不会和HTML，CSS或其他界面组件混合。==
  - ==每个微服务都有自己的存储能力，可以有自己的数据库。也可以有统一的数据库。==

- ==缺点==
  - 开发人员要处理分布式系统的复杂性。
  - 多服务运维难度，随着服务的增加，运维的压力也在增大。
  - 系统部署依赖。
  - 服务间通信成本。
  - 数据一致性。
  - 系统集成测试。
  - 性能监控……

## 4、微服务技术栈有哪些

微服务技术栈：多种技术的集合体

| ==微服务条目==                           | ==落地技术==                                                 | ==备注== |
| ---------------------------------------- | ------------------------------------------------------------ | -------- |
| 服务开发                                 | SpringBoot、Spring、SpringMVC                                |          |
| 服务配置与管理                           | Netflix公司的Archaius、阿里的Diamond等                       |          |
| 服务注册与发现                           | Eureka、Consul、Zookeeper等                                  |          |
| 服务调用                                 | Rest、RPC、gRPC                                              |          |
| 服务熔断器                               | Hystrix、Envoy等                                             |          |
| 负载均衡                                 | Ribbon、Nginx等                                              |          |
| 服务接口调用（客户端调用服务的简化工具） | Feign等                                                      |          |
| 消息队列                                 | Kafka、RabbitMQ、ActiveMQ等                                  |          |
| 服务配置中心管理                         | SpringCloudConfig、Chef等                                    |          |
| 服务路由（API网关）                      | Zuul等                                                       |          |
| 服务监控                                 | Zabbix、Nagios、Metrics、Spectator等                         |          |
| 全链路追踪                               | Zipkin、Brave、Dapper等                                      |          |
| 服务部署                                 | Docker、OpenStack、Kubernetes等                              |          |
|                                          | SpringCloud Stream（封装与Redis、Rabbit、Kafka等发送接收消息） |          |
| 事件消息总线                             | Spring Cloud Bus                                             |          |

## 5、为什么选择SpringCloud作为微服务架构

1. 选型依据

   1. 整体解决方案和框架成熟度
   2. 社区热度
   3. 可维护性
   4. 学习曲线

2. 当前各大IT公司用的微服务架构有哪些？

   1. 阿里Dubbo/HSF
   2. 京东JSF
   3. 新浪微博Motan
   4. 当当网DubboX

3. 各微服务框架对比

   | 框架           | Netflix/SpringCloud                                          | Motan                                                        | gRPC                      | Thrift   | Dubbo/DubboX     |
   | -------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------- | -------- | ---------------- |
   | 功能定位       | 完整的微服务框架                                             | RPC框架，但整合了ZK或Consul，实现集群环境的基本服务注册/发现 | RPC框架                   | RPC框架  | 服务框架         |
   | 支持Rest       | 是 Ribbon支持多种可插拔的序列化选择                          | 否                                                           | 否                        | 否       | 否               |
   | 支持RPC        | 否                                                           | 是（Hession2）                                               | 是                        | 是       | 是               |
   | 支持多语言     | 是(Rest)形式?                                                | 否                                                           | 是                        | 是       | 否               |
   | 服务注册/发现  | 是（Eureka）Eureka服务注册表，Karyon服务端框架支持服务自注册和健康检查 | 是（zookeeper/consul）                                       | 否                        | 否       | 是               |
   | 负载均衡       | 是(服务端zuul+客户端Ribbon)Zuul-服务，动态路由 云端负载均衡Eureka（针对中间层服务器） | 是(客户端)                                                   | 否                        | 否       | 是(客户端)       |
   | 配置服务       | Netflix Archaius SpringCloud Config Server集中配置           | 是（zookeeper提供）                                          | 否                        | 否       | 否               |
   | 服务调用链监控 | 是(zuul) Zuul提供边缘服务，API网关                           | 否                                                           | 否                        | 否       | 否               |
   | 高可用/容错    | 是（服务端Hystrix+客户端Ribbon）                             | 是（客户端）                                                 | 否                        | 否       | 是（客户端）     |
   | 典型应用案例   | Netflix                                                      | Sina                                                         | Google                    | FaceBook |                  |
   | 社区活跃程度   | 高                                                           | 一般                                                         | 高                        | 一般     | 已经不维护了     |
   | 学习难度       | 中等                                                         | 低                                                           | 高                        | 高       | 低               |
   | 文档丰富度     | 高                                                           | 一般                                                         | 一般                      | 一般     | 高               |
   |                | SpringCloud Bus为我们的应用程序带来了更多管理端点            | 支持降级                                                     | Netflix内部在开发集成gRPC | IDL定义  | 实践的公司比较多 |

   

# 二、SpringCloud入门概述



# 三、Rest微服务构建案例工程模块



# 四、Eureka服务注册与发现



# 五、Ribbon负载均衡



